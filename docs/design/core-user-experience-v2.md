# VibeBox 核心用户体验设计 v2.0

**Tags:** #design:user-experience #design:navigation #feature:mobile-first #feature:subscription #principle:simplicity #principle:experience-over-purity

**状态**: 初稿（Draft）
**版本**: v2.0
**日期**: 2025-10-26
**作者**: Fugen

---

## 文档说明

本文档是基于 2025-10-26 需求梳理会议的核心结论，**完全重新思考**用户体验流程和界面架构。

**核心变化：**
- 从"订阅优先"转变为"体验优先"
- 从"控制台为中心"转变为"聊天为中心"
- 从"注册门槛"转变为"零门槛即用"

**文档定位：**
- ✅ 需求梳理阶段，用于对齐核心策略
- ✅ 整体方向和用户流程设计
- ❌ 不涉及具体代码实现
- ❌ 技术细节将在实施阶段补充

---

## 🎯 核心价值重新定位

### 两个核心原则（最重要）

#### 原则 1：零门槛体验
> "我希望用户不用订阅也可以快速体验，甚至不需要注册流程"

**设计目标：**
- 打开 App → 立即可用
- 无需注册、登录、配置
- 降低流失率，先体验价值再决定付费

#### 原则 2：聊天是核心
> "用户订阅后，最频繁的就是聊天页面，可能有多个会话切换着聊天，这个应该是我们所有体验优化的集中处，也是产品价值最大处。其他一切设计都要围绕这个来。"

**设计目标：**
- 聊天界面是主界面（占据最高优先级）
- 多会话切换必须高效、流畅
- 所有其他功能（服务器管理、订阅、设置）都是辅助

---

## 🔑 账户与试用策略

### 匿名账户机制

**核心策略：**
用户首次打开 App 时，系统**自动创建匿名账户**（无需用户感知）

**技术要点：**
- 使用设备唯一标识（Device ID）生成账户
- Token 存储在本地安全存储（SecureStore）
- 用户无需输入任何信息

**优势：**
- ✅ 零门槛：打开即用，无摩擦
- ✅ 数据保留：用户聊天记录本地保存
- ✅ 转化准备：试用结束后引导订阅

---

### 试用机制：3 天免费试用

**试用内容：**
- 新用户赠送 **3 天免费试用**
- 试用期内可无限次对话（使用共享 API Key，有速率限制）
- 试用期内访问完整功能（聊天、会话管理）

**试用期显示：**
- 顶部状态栏显示：`🎁 试用中 · 剩余 2 天 3 小时`
- 不影响聊天体验（非强提示）

**试用结束后：**
- 用户发送消息时，弹出订阅引导弹窗
- 聊天记录保留，订阅后可继续使用

**为什么是 3 天而不是次数限制？**
- ✅ 时间限制更自然（用户不需要计数）
- ✅ 足够体验完整价值（完成一个小项目）
- ✅ 避免"用完即走"（次数限制容易被快速消耗）

---

### 订阅时账户绑定

**时机：**
用户支付成功后，**可选**绑定账户

**绑定方式：**
- 手机号（国内主流）
- 邮箱
- GitHub OAuth
- Google OAuth（国际用户）

**绑定流程：**
```
支付成功
    ↓
显示弹窗："绑定账户以保护你的数据"
    ↓
用户选择：[手机号] [邮箱] [GitHub] [Google]
    ↓
或者：点击"稍后绑定"跳过
    ↓
绑定后：匿名账户升级为正式账户
    ↓
未绑定：继续使用匿名账户（单设备，无云同步）
```

**绑定的好处（引导用户绑定）：**
- ✅ 多设备同步（手机、平板、电脑）
- ✅ 数据安全（云端备份）
- ✅ 换设备不丢失数据

**不绑定的限制：**
- ⚠️ 仅限当前设备使用
- ⚠️ 卸载 App 后数据丢失
- ⚠️ 无法在其他设备登录

---

## 📱 界面架构设计

### 业界调研结论

**2024-2025 年主流消息应用导航模式：**

| 应用 | 月活用户 | 导航模式 | Tab 数量 |
|------|---------|---------|---------|
| **WhatsApp**（美国） | 9800 万 | 底部 Tab Bar | 4 Tab（Chats/Communities/Status/Calls） |
| **Slack**（专业工具） | - | 底部 Tab Bar（2024 重新设计） | 4 Tab（Home/DMs/Activity/You） |
| **Discord**（年轻用户） | 9 亿 | 底部 Tab Bar（2024 更新） | 4 Tab（Servers/Messages/Notifications/You） |
| **微信**（中国） | 12 亿 | 底部 Tab Bar | 4 Tab（微信/通讯录/发现/我） |

**共同趋势：**
- ✅ **底部 Tab Bar 是行业标准**（取代了旧的顶部 Tab 或侧边栏）
- ✅ 通常 3-5 个 Tab
- ✅ 最后一个 Tab 通常是 "You" / "Me"（个人中心）

---

### VibeBox 导航结构：2 Tab (MVP 简化版)

> **📝 设计演进说明（2025-11-10）**
>
> 原设计为 3 Tab (Chats/Boxes/Me)，但 MVP 阶段简化为 2 Tab (Chats/Settings)，订阅管理整合到 Settings 内。
> 详见：`boxes-tab-redesign.md` (Settings 整合方案)

```
┌─────────────────────────────────────────┐
│                                         │
│          主内容区域                      │
│                                         │
│                                         │
│                                         │
│                                         │
├─────────────────────────────────────────┤
│  💬               ⚙️                    │
│ Chats           Settings                │
└─────────────────────────────────────────┘
```

**Tab 说明：**

| Tab | 中文名 | 核心功能 | 参考对象 |
|-----|-------|---------|---------|
| 💬 **Chats** | 聊天 | 会话列表（多个 Claude Code 对话）<br>这是**核心主界面** | 微信"聊天"<br>WhatsApp "Chats" |
| ⚙️ **Settings** | 设置 | 账户信息、**订阅管理**、Machines、设置 | iOS Settings<br>Android Settings |

**Settings 页面结构：**
- 订阅管理（Subscription Management）← VibeBox 核心价值入口
- Machines（现有的设备列表，显示所有 Boxes）
- Connected Accounts（Claude、GitHub、Logto）
- Features（账户、外观、语音助手等）
- About（更新日志、隐私政策等）

**设计原则：**
- **Chats Tab 是默认主界面**（用户打开 App 直接看到）
- **订阅管理在 Settings 内突出显示**（用户购买的核心价值）
- **Machines 展示所有 Boxes**（设备列表已有完整功能）
- 遵循主流应用的用户习惯（大多数应用把订阅放在 Settings）

---

### 为什么 MVP 选择 2 Tab？

**MVP 设计演进：**

**原方案：3 Tab (Chats/Boxes/Me)**
- ✅ 核心价值突出（Boxes 独立 tab）
- ❌ 需要三栏布局（Web/Desktop）→ 实现成本过高
- ❌ 大多数用户只有 1 Box → 独立 tab 显得空旷

**新方案：2 Tab (Chats/Settings，订阅整合到 Settings)**
- ✅ 实现成本低（保持现有两栏布局）
- ✅ 符合行业标准（Netflix、Spotify 都在 Settings 管理订阅）
- ✅ 简洁清晰（MVP 阶段 Simplicity > Features）
- ⚠️ 订阅可见性稍降（但在 Settings 内突出显示）

**考虑过的其他方案：**
- ❌ 5 Tab（Dashboard/Session/Terminal/Inbox/Settings）→ 太复杂，分散注意力
- ❌ 单页 + 侧边栏 → 移动端屏幕小，侧边栏体验差
- ✅ **2 Tab（Chats/Settings）** → MVP 最佳平衡

**为什么这个"折衷"是合理的：**
1. **订阅管理是低频操作**：用户设置一次后，月度/年度才改动
2. **Machines 已有完整展示**：现有设备列表已展示所有 Boxes
3. **Settings 是用户心智模型**："在哪管理订阅？" → "Settings"
4. **可逐步演进**：如果多 Box 用户增长，未来可恢复独立 Boxes Tab

---

### Boxes 的品牌故事和定位

#### 品牌一致性：VibeBox → Boxes

```
产品名：VibeBox（氛围盒子）
    ↓
核心概念：Box（盒子）
    ↓
用户理解：
"每个 Box 是一个独立的'氛围空间'
 装有完整的开发环境和 AI 助手
 你可以在其中创建多个项目会话"
    ↓
用户体验：
1. 打开 App → Chats（聊天列表）
2. 查看资源 → Boxes（我购买的 Box）
3. 管理账户 → Me（个人中心）
```

**品牌叙事：**
> "VibeBox 给你提供一个个'盒子'（Boxes），每个盒子是一个独立的创作空间，装有 AI 助手和完整开发环境。你可以在不同的 Box 中创建多个项目对话，随时切换、随时创作。"

---

#### Boxes 的核心定位

**类似"联系人"的概念（但更丰富）**

在微信中：
- 联系人列表 = 你可以聊天的对象
- 点击联系人 → 进入聊天 → 创建多个话题会话

在 VibeBox 中：
- Boxes 列表 = 你可以使用的开发环境
- 点击 Box → 查看详情 → 创建多个项目会话

**关键特性：**
1. **一对多关系**：一个 Box 可以创建多个会话（Chat）
2. **独立环境**：每个 Box 是独立的开发环境（隔离的服务器/容器）
3. **类型多样**：未来支持不同类型的 Box

**示例：**
```
用户 A 有 3 个 Boxes：
├─ Personal Box（个人项目）
│  └─ 5 个会话：Todo App, Blog, Portfolio...
│
├─ Work Box（公司项目）
│  └─ 3 个会话：API 开发, 前端重构...
│
└─ Experiment Box（实验环境）
   └─ 2 个会话：新技术尝试...
```

---

#### 未来扩展性

**不同类型的 Boxes：**

1. **配置差异**
   - 基础 Box：1核2G（适合小项目）
   - 专业 Box：2核4G（适合大项目）
   - 团队 Box：4核8G（多人协作）

2. **工具差异**
   - Frontend Box：预装 Node.js, React, Vue, Vite
   - Backend Box：预装 Python, Django, FastAPI, PostgreSQL
   - Full-Stack Box：前后端工具都有

3. **厂商差异**
   - AWS Box：运行在 AWS EC2
   - 阿里云 Box：运行在阿里云 ECS
   - 本地 Box：运行在用户自己的电脑（未来可能）

4. **模板 Box**
   - Django 项目模板 Box
   - React 项目模板 Box
   - 微服务架构模板 Box

---

#### 命名决策历程

**讨论过的命名方案：**

| 名称 | 优势 | 劣势 | 最终决策 |
|------|------|------|---------|
| **Servers** | 具体明确，零认知成本 | 技术化，未来扩展受限 | ❌ |
| **Workspaces** | 用户熟悉（Slack），扩展性强 | 不够独特，品牌一致性弱 | ❌ |
| **Agents** | AI 时代流行，技术前瞻 | 可能过于技术化 | ❌ |
| **Boxes** | 品牌一致性强，温暖，扩展性强 | 认知成本稍高（但可通过设计降低） | ✅ |

**最终选择 Boxes 的理由：**
1. **品牌一致性最强**：VibeBox → Boxes 完美呼应
2. **用户购买的核心价值**："Box" 就是产品本身
3. **扩展性强**：Box 可以装任何东西（服务器、容器、模板）
4. **温度感**：相比 "Servers"，"Boxes" 更有温度
5. **认知成本可控**：通过界面设计（副标题、引导）降低理解门槛

**认知成本解决方案：**
- Tab 副标题：`📦 Boxes（环境）`
- 空状态引导："每个 Box 可以创建多个会话"
- 用户自定义命名：Todo App 开发 Box、个人博客 Box

---

## 🚀 完整用户流程

### 流程 1：新用户首次使用

```
┌─────────────────────────────────────────┐
│ 1. 打开 App                              │
│    - 无需登录/注册                        │
│    - 系统自动创建匿名账户（后台静默完成）   │
│    - 开始 3 天试用期                      │
└─────────────────────────────────────────┘
              ↓
┌─────────────────────────────────────────┐
│ 2. 进入 Chats Tab（空状态）               │
│    - 显示引导提示：                       │
│      "🎉 欢迎使用 VibeBox"               │
│      "新用户赠送 3 天免费试用"            │
│      [创建第一个会话]                     │
└─────────────────────────────────────────┘
              ↓
┌─────────────────────────────────────────┐
│ 3. 点击"创建第一个会话"                   │
│    - 自动创建新会话                       │
│    - 进入聊天详情页                       │
│    - 顶部显示试用状态：                   │
│      "🎁 试用中 · 剩余 3 天"              │
└─────────────────────────────────────────┘
              ↓
┌─────────────────────────────────────────┐
│ 4. 开始对话                              │
│    - 用户输入："帮我写一个 TODO App"     │
│    - Claude 正常响应                     │
│    - 完全正常使用，无任何限制提示          │
└─────────────────────────────────────────┘
```

**关键点：**
- ✅ 零门槛：无需任何注册/登录操作
- ✅ 即时体验：打开即用，无配置等待
- ✅ 无感知：用户不知道后台创建了匿名账户
- ✅ 非强提示：试用状态仅在顶部轻量显示，不打断体验

---

### 流程 2：试用到期 → 订阅转化

```
┌─────────────────────────────────────────┐
│ 1. 试用期结束（3 天后）                   │
│    - 用户在聊天详情页输入消息              │
│    - 点击"发送"按钮                       │
└─────────────────────────────────────────┘
              ↓
┌─────────────────────────────────────────┐
│ 2. 显示订阅弹窗（覆盖在聊天页上）          │
│                                         │
│    ┌─────────────────────────────┐     │
│    │ 🚀 试用期已结束              │     │
│    │                             │     │
│    │ 订阅继续使用                 │     │
│    │                             │     │
│    │ VibeBox Pro                 │     │
│    │ $24/月 或 $192/年           │     │
│    │                             │     │
│    │ ✓ 无忧 AI 编码              │     │
│    │ ✓ 无忧 Claude API           │     │
│    │ ✓ 2核4G 专属服务器          │     │
│    │                             │     │
│    │ [订阅]  [稍后再说]           │     │
│    └─────────────────────────────┘     │
│                                         │
└─────────────────────────────────────────┘
              ↓
┌─────────────────────────────────────────┐
│ 3. 点击"订阅"                            │
│    - Web：跳转到 Stripe Checkout        │
│    - iOS：调起 Apple IAP 流程            │
│    - Android：调起 Google Play 订阅      │
└─────────────────────────────────────────┘
              ↓
┌─────────────────────────────────────────┐
│ 4. 支付成功                              │
│    - Web：从 Stripe 返回                 │
│    - 移动：订阅完成，返回 App             │
└─────────────────────────────────────────┘
              ↓
┌─────────────────────────────────────────┐
│ 5. 显示账户绑定弹窗（可选）                │
│                                         │
│    ┌─────────────────────────────┐     │
│    │ ✓ 支付成功！                │     │
│    │                             │     │
│    │ 绑定账户以保护你的数据       │     │
│    │                             │     │
│    │ [手机号] [邮箱] [GitHub]    │     │
│    │                             │     │
│    │ [稍后绑定]                   │     │
│    └─────────────────────────────┘     │
│                                         │
└─────────────────────────────────────────┘
              ↓
┌─────────────────────────────────────────┐
│ 6. 立即可用                              │
│    - 弹窗消失                            │
│    - 回到聊天页面                        │
│    - 顶部状态变为："💎 Pro · 无忧使用"   │
│    - **无需等待配置**（资源池预热）       │
│    - 继续刚才的对话                      │
└─────────────────────────────────────────┘
```

**关键点：**
- ✅ 弹窗式订阅：不离开聊天页面
- ✅ 支付后立即可用：无配置等待（资源池预热策略）
- ✅ 账户绑定可选：不强制，可稍后绑定
- ✅ 无缝体验：订阅完成后继续刚才的对话

---

### 流程 3：订阅用户日常使用

```
┌─────────────────────────────────────────┐
│ 1. 打开 App                              │
│    - 自动进入 Chats Tab（会话列表）       │
│    - 顶部显示："💎 Pro · 无忧使用"       │
└─────────────────────────────────────────┘
              ↓
┌─────────────────────────────────────────┐
│ 2. 查看会话列表                          │
│                                         │
│    🤖 Todo App 项目                     │
│       Claude: 已添加删除功能...          │
│       2分钟前                            │
│                                         │
│    🤖 Blog 设计                         │
│       You: 帮我优化首页布局              │
│       1小时前                            │
│                                         │
│    🤖 API 开发                          │
│       Claude: 数据库设计完成             │
│       昨天                               │
└─────────────────────────────────────────┘
              ↓
┌─────────────────────────────────────────┐
│ 3. 会话切换（微信模式）                   │
│                                         │
│    选项 A：点击某个会话 → 进入聊天详情    │
│    选项 B：点击 [+] → 创建新会话         │
│    选项 C：下拉刷新会话列表               │
└─────────────────────────────────────────┘
              ↓
┌─────────────────────────────────────────┐
│ 4. 在聊天详情页对话                      │
│    - 与 Claude Code 正常对话             │
│    - 查看代码、运行代码、管理文件         │
│    - 顶部显示"💎 Pro · 无忧使用"         │
└─────────────────────────────────────────┘
              ↓
┌─────────────────────────────────────────┐
│ 5. 需要切换会话                          │
│    - 点击左上角返回按钮 → 回到会话列表    │
│    - 选择另一个会话 → 继续对话            │
└─────────────────────────────────────────┘
              ↓
┌─────────────────────────────────────────┐
│ 6. 需要管理 Box                          │
│    - 切换到 Boxes Tab                    │
│    - 查看实例状态、SSH 信息               │
│    - 执行重启/停止操作                    │
└─────────────────────────────────────────┘
              ↓
┌─────────────────────────────────────────┐
│ 7. 查看订阅/账单                         │
│    - 切换到 Me Tab                       │
│    - 查看订阅状态、API 用量详情           │
│    - 续费/升级/账单历史                   │
└─────────────────────────────────────────┘
```

**关键点：**
- ✅ 会话列表是默认主界面
- ✅ 会话切换：返回列表 → 选择下一个（微信模式）
- ✅ Box 管理、订阅管理在独立 Tab（不干扰聊天）

---

## 💳 订阅流程：弹窗式设计

### 核心设计原则

**旧设计问题：**
```
选套餐页 → 支付页 → 配置进度页 → 控制台
（4 个页面跳转，用户需要等待 2-3 分钟配置）
```

**新设计：弹窗式订阅**
```
聊天页（不离开）→ 弹出订阅弹窗 → 跳转支付（Stripe/IAP/Google Play）→ 立即可用
（最小化跳转，支付后立即可用）
```

---

### 套餐策略

**当前策略：单一 SKU**

```
VibeBox Pro
$24/月 或 $192/年（节省 33%）

✓ 无忧 AI 编码
✓ 无忧 Claude API 用量
✓ 2核4G 专属服务器
✓ 预装环境（Claude Code, Node.js, Python, Nginx）
✓ 完全 Root 权限
✓ 支持订阅多个 Box（通过 Quantity）
```

**为什么只有一个 SKU？**
- ✅ **Simplicity > Features**（极简原则）
- ✅ 降低选择成本（避免决策疲劳）
- ✅ 清晰定价（无需对比）
- ✅ MVP 快速验证（后续可扩展多套餐）

**多 Box 支持：**
- 用户可通过 Quantity 订阅多个 Box
- 每个 Box 独立分配服务器和 API Key
- 每个 Box 有独立的 API 额度

---

### 支付方式

**多平台支付策略**

根据用户所在平台自动选择对应的支付方式：

- **Web 平台**: Stripe Checkout
  - 支持信用卡、借记卡
  - 订阅管理由 Stripe 处理
  - 支持全球用户

- **iOS 平台**: Apple In-App Purchase (IAP)
  - 遵循 App Store 订阅规范
  - 自动续订由 Apple 管理
  - 支持家庭共享

- **Android 平台**: Google Play Billing
  - 遵循 Play Store 订阅规范
  - 自动续订由 Google 管理
  - 统一的订阅管理体验

---

### 支付流程（多平台）

#### Web 端：Stripe Checkout

```
点击"订阅"按钮
    ↓
跳转到 Stripe Checkout 页面
    ↓
用户输入信用卡信息
    ↓
确认订阅
    ↓
支付成功后重定向回 VibeBox
    ↓
后端接收 Stripe Webhook
    ↓
支付成功 → 分配 Box → 立即可用
```

#### iOS：Apple In-App Purchase

```
点击"订阅"按钮
    ↓
调起 Apple IAP 流程
    ↓
用户使用 Apple ID 确认订阅
    ↓
订阅完成，返回 App
    ↓
App 验证收据，通知后端
    ↓
后端接收 App Store Server Notification
    ↓
支付成功 → 分配 Box → 立即可用
```

#### Android：Google Play Billing

```
点击"订阅"按钮
    ↓
调起 Google Play 订阅流程
    ↓
用户使用 Google 账户确认订阅
    ↓
订阅完成，返回 App
    ↓
App 验证购买，通知后端
    ↓
后端接收 Google Play Developer Notification
    ↓
支付成功 → 分配 Box → 立即可用
```

---

### 支付成功后的即时可用策略

**问题：用户不应该等待配置**

**旧设计：**
```
支付成功 → 显示配置进度条（2-3分钟）→ 配置完成 → 可用
```

**新设计：资源池预热**
```
【后台资源池】
- 始终保持 5-10 个预配置好的 VibeBox 实例
- 实例已安装好所有环境（Claude Code, Node.js, Python, Nginx）
- 实例已配置好网络、安全策略

【用户支付成功】
- 立即从资源池分配一个实例（< 1 秒）
- 注入用户专属 API Key（带额度限制）
- 绑定到用户账户

【后台异步补充】
- 检测资源池数量
- 自动补充新实例（用户无感知）
- 保持最小可用数量
```

**优势：**
- ✅ 用户支付后**立即可用**（无需等待）
- ✅ 用户体验极佳（无感知配置过程）
- ✅ 成本可控（动态调整资源池大小）

---

## 💬 会话切换交互（微信模式）

### 设计方案选择

**讨论过的方案：**
- ❌ 方案 A（ChatGPT 模式）：侧边栏 + 滑动手势
- ✅ **方案 B（微信模式）：会话列表优先** ← 采用
- ❌ 方案 C（Telegram 模式）：手势增强
- ❌ 方案 D（混合创新模式）：置顶 + 快速切换

**最终选择：方案 B（微信模式）**

**理由：**
- ✅ 用户最熟悉（微信 12 亿月活，WhatsApp 20 亿月活）
- ✅ 实现简单（标准列表 + 详情页）
- ✅ 符合移动端习惯（大部分消息应用的标准模式）
- ✅ 学习成本为零

---

### 交互流程

```
【Chats Tab - 会话列表】
┌─────────────────────────────────────────┐
│ Chats                      [+] [搜索] │  ← 标题栏
├─────────────────────────────────────────┤
│                                         │
│ 🤖 Todo App 项目                        │  ← 会话卡片
│    Claude: 已添加删除功能...             │
│    2分钟前                               │
│                                         │
│ 🤖 Blog 设计                            │
│    You: 帮我优化首页布局                 │
│    1小时前                               │
│                                         │
│ 🤖 API 开发                             │
│    Claude: 数据库设计完成                │
│    昨天                                 │
│                                         │
│                                         │
├─────────────────────────────────────────┤
│  💬        🖥️        👤                 │
│ Chats    Servers    Me                  │
└─────────────────────────────────────────┘

点击会话 → 进入聊天详情

【聊天详情页】
┌─────────────────────────────────────────┐
│ [<] Todo App 项目            [...] │  ← 返回按钮
├─────────────────────────────────────────┤
│                                         │
│  👤 You: 帮我写一个 TODO App            │
│                                         │
│  🤖 Claude: 好的，我来创建...           │
│     [查看代码] [运行]                    │
│                                         │
│  👤 You: 加一个删除功能                 │
│                                         │
│  🤖 Claude: 已添加删除功能...           │
│                                         │
│                                         │
├─────────────────────────────────────────┤
│ [📎] 输入消息...               [发送] │
└─────────────────────────────────────────┘

点击左上角返回 → 回到会话列表 → 选择下一个会话
```

---

### 会话列表功能

**基础功能：**
- 显示所有会话（最新的在最上面）
- 会话卡片显示：会话名称、最后一条消息预览、时间
- 点击会话 → 进入聊天详情
- 右上角 `[+]` → 新建会话
- 右上角 `[搜索]` → 搜索会话或消息内容

**手势操作（可选，未来扩展）：**
- 向左滑动会话 → 显示删除按钮
- 向右滑动会话 → 显示置顶按钮
- 长按会话 → 显示更多操作菜单（重命名/删除/归档）

**下拉刷新：**
- 下拉会话列表 → 刷新会话状态
- 同步云端会话（已绑定账户的用户）

---

### 会话排序

**默认排序：**
按最后消息时间倒序（最新的在最上面）

**未来可扩展：**
- 置顶会话（置顶的会话始终在最上方）
- 未读消息优先（有未读消息的会话在上方）
- 手动排序（用户拖拽调整顺序）

---

## 📊 与旧设计的对比

### 核心差异

| 维度 | 旧设计（PRD v1.0） | 新设计（本文档 v2.0） |
|------|-------------------|---------------------|
| **首次体验** | 注册/登录 → 选套餐 → 支付 → 配置等待 | 打开即用（匿名账户 + 3 天试用） |
| **导航结构** | 5 Tab（Dashboard/Session/Terminal/Inbox/Settings） | 3 Tab（Chats/Boxes/Me） |
| **核心界面** | Dashboard（实例管理） | Chats（会话列表） |
| **订阅流程** | 独立页面流程（Plans → Checkout → Provisioning） | 弹窗式订阅（不离开聊天页） |
| **会话切换** | Session Tab → 会话列表 → 聊天详情 | Chats Tab → 会话列表 → 聊天详情（微信模式） |
| **Box 管理** | Dashboard → VibeBox 卡片 | Boxes Tab → Box 列表（品牌一致性） |
| **账户绑定** | 注册时必须绑定 | 订阅后可选绑定 |
| **配置等待** | 显示进度条（2-3 分钟） | 无需等待（资源池预热，立即可用） |
| **套餐选择** | 多套餐对比（基础版/专业版） | 单一 SKU（Pro $24/月或$192/年） |
| **登录认证** | Logto OAuth（GitHub/Google/手机号） | 匿名账户 → 订阅后可选绑定 |

---

### 设计理念转变

**旧设计核心：**
- 以"服务器实例"为中心
- 用户需要先订阅，才能体验
- Dashboard 是主界面（查看实例状态、API 用量）

**新设计核心：**
- 以"聊天对话"为中心，Box 为核心价值
- 用户先体验，再决定订阅
- Chats 是主界面（会话列表、聊天详情）
- Boxes 突出展示（品牌一致性，核心价值）

**转变原因：**
> "用户订阅后，最频繁的就是聊天页面，可能有多个会话切换着聊天，这个应该是我们所有体验优化的集中处，也是产品价值最大处。"
>
> "用户购买的主要是 Box（VibeBox），还是给个好位置显示才对。我们确实是一个 box, vibe box。"

**核心洞察：**
- 用户购买的是 "VibeBox"（AI 编程盒子），不只是"服务器"
- Box 是产品本身，应该突出展示（品牌一致性）
- 聊天是使用频率最高的功能，是主界面
- 界面应该反映：使用频率（Chats 第一）+ 核心价值（Boxes 第二）

---

## 📋 关键页面概览

### 1. Chats Tab（会话列表）

**状态 1：空状态（新用户）**
```
┌─────────────────────────────────────────┐
│ Chats                                   │
├─────────────────────────────────────────┤
│                                         │
│      🎉 欢迎使用 VibeBox                │
│                                         │
│      新用户赠送 3 天免费试用             │
│                                         │
│      [创建第一个会话]                    │
│                                         │
│                                         │
├─────────────────────────────────────────┤
│  💬        🖥️        👤                 │
│ Chats    Servers    Me                  │
└─────────────────────────────────────────┘
```

**状态 2：有会话（正常使用）**
```
┌─────────────────────────────────────────┐
│ Chats                      [+] [搜索] │
├─────────────────────────────────────────┤
│                                         │
│ 🤖 Todo App 项目                        │
│    Claude: 已添加删除功能...             │
│    2分钟前                               │
│                                         │
│ 🤖 Blog 设计                            │
│    You: 帮我优化首页布局                 │
│    1小时前                               │
│                                         │
│ 🤖 API 开发                             │
│    Claude: 数据库设计完成                │
│    昨天                                 │
│                                         │
├─────────────────────────────────────────┤
│  💬        📦        👤                 │
│ Chats     Boxes      Me                 │
└─────────────────────────────────────────┘
```

---

### 2. Boxes Tab（Box 列表）

**状态 1：未订阅（试用期）**
```
┌─────────────────────────────────────────┐
│ Boxes                                   │
├─────────────────────────────────────────┤
│                                         │
│      📦 还没有专属 Box                  │
│                                         │
│      订阅后获取 2核4G VibeBox            │
│                                         │
│      [查看订阅方案]                      │
│                                         │
│                                         │
├─────────────────────────────────────────┤
│  💬        📦        👤                 │
│ Chats     Boxes      Me                 │
└─────────────────────────────────────────┘
```

**状态 2：已订阅（单个 Box）- 详细视图**

大多数用户只有 1 个 Box，因此需要丰富信息展示，避免页面显得空荡。

```
┌─────────────────────────────────────────┐
│ Boxes                       [+]         │
├─────────────────────────────────────────┤
│                                         │
│ 📦 我的 VibeBox                         │
│                                         │
│ ┌─────────────────────────────────┐   │
│ │ 🟢 VibeBox Pro                  │   │
│ │                                 │   │
│ │ 📊 状态总览                      │   │
│ │ · 配置：2核4G · 40GB SSD        │   │
│ │ · 状态：运行中（已运行 3 天）    │   │
│ │ · API：✓ 无忧使用               │   │
│ │ · 性能：CPU 15% · 内存 40%      │   │
│ │                                 │   │
│ │ 💬 活跃会话（5）                │   │
│ │ · Todo App 项目                 │   │
│ │ · Blog 设计                     │   │
│ │ · API 开发                      │   │
│ │ [查看全部会话]                   │   │
│ │                                 │   │
│ │ 🔧 快捷操作                      │   │
│ │ [打开终端] [SSH 信息]            │   │
│ │ [重启] [停止]                    │   │
│ └─────────────────────────────────┘   │
│                                         │
└─────────────────────────────────────────┘
```

**关键设计：**
- ✅ 丰富的信息展示（不显得空荡）
- ✅ 关联会话列表（体现 Box 与会话的一对多关系）
- ✅ 快捷操作（高频需求直接操作）
- ✅ 性能监控（CPU、内存）

---

**状态 3：已订阅（多个 Box）- 列表视图**

未来用户可能拥有多个 Box（不同配置、不同项目）。

```
┌─────────────────────────────────────────┐
│ Boxes                       [+] [搜索] │
├─────────────────────────────────────────┤
│                                         │
│ 📦 VibeBox Pro #1                       │
│    2核4G · 运行中 · 5 个活跃会话        │
│    API: ✓ 无忧使用                     │
│    [查看详情]                           │
│                                         │
│ 📦 VibeBox Pro #2                       │
│    2核4G · 运行中 · 2 个活跃会话        │
│    API: ✓ 无忧使用                     │
│    [查看详情]                           │
│                                         │
│ 📦 Testing Box                          │
│    1核2G · 停止中                       │
│    [启动]                               │
│                                         │
│ [+ 添加新 Box]                          │
│                                         │
└─────────────────────────────────────────┘
```

**关键设计：**
- ✅ 列表卡片展示（多个 Box）
- ✅ 快速状态浏览（配置、状态、会话数、API 用量）
- ✅ 快捷操作（查看详情、启动）
- ✅ 添加新 Box（右上角 [+] 或底部按钮）

---

**Box 详情页（点击"查看详情"）**

```
┌─────────────────────────────────────────┐
│ [<] VibeBox Pro #1                      │
├─────────────────────────────────────────┤
│                                         │
│ 📊 实例状态                              │
│ ● 运行中（已运行 3 天 2 小时）           │
│                                         │
│ 🖥️ 服务器信息                           │
│ IP: 123.45.67.89                        │
│ 配置: 2核4G 40GB SSD                    │
│ 套餐: Pro ($24/月 或 $192/年)           │
│ 地域: 华东（上海）                      │
│                                         │
│ ✓ API 状态                              │
│ 无忧使用 Claude API                     │
│ (MVP 阶段不显示用量数字)                │
│                                         │
│                                         │
│ 💬 关联会话（5 个）                     │
│ · Todo App 项目（活跃中）               │
│ · Blog 设计（活跃中）                   │
│ · API 开发（2 天前）                    │
│ · 移动端 UI（1 周前）                   │
│ · 数据分析（归档）                       │
│ [查看全部会话] [创建新会话]              │
│                                         │
│ 📈 性能监控                              │
│ CPU: 15% [████░░░░░░░░] 2/4核         │
│ 内存: 40% [█████░░░░░░] 1.6/4GB       │
│ 磁盘: 12% [██░░░░░░░░░] 5/40GB         │
│                                         │
│ 🔐 连接信息                             │
│ SSH: ssh root@123.45.67.89             │
│ [显示密码] [复制连接命令]                │
│                                         │
│ 🔧 实例控制                             │
│ [打开终端] [重启] [停止] [删除]          │
│                                         │
└─────────────────────────────────────────┘
```

---

### 3. Me Tab（个人中心）

**状态 1：试用期（匿名账户）**
```
┌─────────────────────────────────────────┐
│ Me                                      │
├─────────────────────────────────────────┤
│                                         │
│ ┌─────────────────────────────────┐   │
│ │ 👤 试用用户                      │   │
│ │ 🎁 试用期 · 剩余 2 天 3 小时     │   │
│ │ [订阅 Pro]                       │   │
│ └─────────────────────────────────┘   │
│                                         │
│ ⚙️ 设置                                │
│ ├─ 外观设置（深色模式）                  │
│ ├─ 通知设置                             │
│ └─ 语言与地区                           │
│                                         │
│ 📖 帮助与支持                           │
│ ├─ 使用教程                             │
│ ├─ 常见问题                             │
│ └─ 联系客服                             │
│                                         │
├─────────────────────────────────────────┤
│  💬        📦        👤                 │
│ Chats     Boxes      Me                 │
└─────────────────────────────────────────┘
```

**状态 2：已订阅（Pro 用户）**
```
┌─────────────────────────────────────────┐
│ Me                                      │
├─────────────────────────────────────────┤
│                                         │
│ ┌─────────────────────────────────┐   │
│ │ 👤 张三                          │   │
│ │ 💎 Pro 会员 · 到期 2024-12-30    │   │
│ │ [管理订阅]                       │   │
│ └─────────────────────────────────┘   │
│                                         │
│ 💳 账户与订阅                           │
│ ├─ 我的订阅（Pro · $24/月）             │
│ ├─ 续费/升级                            │
│ └─ 账单历史                             │
│                                         │
│ 📊 使用统计                             │
│ ├─ 我的 Boxes（可订阅更多）              │
│ └─ 会话历史                             │
│                                         │
│ ⚙️ 设置                                │
│ ├─ 账户设置（绑定手机/邮箱）             │
│ ├─ 外观设置                             │
│ ├─ 通知设置                             │
│ └─ 语言与地区                           │
│                                         │
│ 📖 帮助与支持                           │
│                                         │
│ [退出登录]                              │
│                                         │
├─────────────────────────────────────────┤
│  💬        📦        👤                 │
│ Chats     Boxes      Me                 │
└─────────────────────────────────────────┘
```

---

## 🔄 顶部状态栏（订阅状态提示）

**设计目的：**
在聊天详情页顶部显示用户当前订阅状态，MVP 阶段不显示 API 用量数字。

**状态 1：试用期**
```
┌───────────────────────────────┐
│ 🎁 试用中 · 剩余 2 天 3 小时   │
└───────────────────────────────┘
```

**状态 2：已订阅 Pro（正常）**
```
┌───────────────────────────────┐
│ 💎 Pro · 无忧使用              │
└───────────────────────────────┘
```

**状态 3：订阅即将到期（提醒）**
```
┌───────────────────────────────┐
│ ⚠️ 7 天后到期 [续费]          │
└───────────────────────────────┘
```

**状态 4：订阅已过期**
```
┌───────────────────────────────┐
│ ❌ 订阅已过期 [立即续费]       │
└───────────────────────────────┘
```

**MVP 阶段说明：**
- ✅ 不显示 API 用量数字或百分比
- ✅ 让用户觉得"无忧，用不完"
- ✅ 如果触发后台防滥用上限（极端情况），平台通过邮件联系用户

**交互：**
- 点击状态栏 → 跳转到 Me Tab（我的订阅页面）

---

## 🎯 待定事项（Open Questions）

以下是需要进一步讨论和决策的问题：

### 1. 试用期策略细节

**问题：**
- 试用期使用的 API Key 是共享 Key 还是独立 Key？
- 共享 Key 是否需要设置速率限制（防止滥用）？
- 试用期是否限制某些高级功能（如终端访问、SSH）？

**待决策：**
- [ ] 确定试用期 API Key 策略
- [ ] 确定试用期功能限制范围

---

### 2. 匿名账户数据迁移

**问题：**
- 用户订阅并绑定账户后，匿名账户的聊天记录如何迁移？
- 是自动合并到云账户，还是用户手动选择？
- 卸载 App 后重新安装，匿名账户数据如何恢复（如果未订阅）？

**待决策：**
- [ ] 确定数据迁移策略
- [ ] 确定本地数据保留策略

---

### 3. 多套餐扩展计划

**问题：**
- 未来是否推出多套餐（基础版/专业版/团队版）？
- 如果推出多套餐，什么时候推出（MVP 后？用户反馈后？）？
- 多套餐的定价和配置差异？

**待决策：**
- [ ] 确定多套餐路线图
- [ ] 确定套餐选择页面设计（如果推出多套餐）

---

### 4. 会话同步策略

**问题：**
- 已绑定账户的用户，会话数据如何在多设备间同步？
- 是实时同步（WebSocket）还是定期同步（轮询）？
- 会话冲突如何处理（两个设备同时编辑同一会话）？

**待决策：**
- [ ] 确定会话同步技术方案
- [ ] 确定冲突解决策略

---

### 5. 国际化支持

**问题：**
- 是否支持英文版（面向国际用户）？
- 如果支持，什么时候推出？
- 支付方式是否需要扩展（Stripe for 国际用户）？

**待决策：**
- [ ] 确定国际化优先级
- [ ] 确定支持的语言和地区

---

### 6. 会话管理高级功能

**问题：**
- 是否支持会话归档（隐藏已完成的项目）？
- 是否支持会话分组/文件夹（组织大量会话）？
- 是否支持会话搜索（搜索历史消息内容）？

**待决策：**
- [ ] 确定会话管理功能优先级
- [ ] 确定 MVP 范围 vs 未来扩展

---

### 7. API 额度管理（已决策）

**决策：**
- MVP 阶段采用"无忧 API"策略，不显示用量数字或进度
- 每个 Box 的 API Key 在 Claude 后台设置每日上限，用于防止极端滥用
- 如果用户触发后台防滥用上限（极端情况），平台通过邮件联系用户
- MVP 阶段暂不提供 API 用量叠加包功能

**未来扩展：**
- 考虑在后续版本显示用量（如需要）
- 考虑提供 Gift Code 兑换功能

---

## 📚 相关文档

### 已存在的设计文档
- [PRD v1.0](./prd.md) - 旧版产品需求文档（已废弃）
- [White Paper](./white-paper.md) - 项目愿景和背景

**已删除的旧版文档（v1.0）**：
- 订阅用户流程（微信支付版）- 已被本文档取代
- 页面架构设计 - 已被本文档取代

### 技术决策文档
- [ADR 001: 客户端技术栈](../decisions/001-client-technology-stack.md)
- [ADR 002: 认证解决方案](../decisions/002-authentication-solution.md)

### 待创建的文档（实施阶段）
- [ ] 实施计划（Implementation Plan v2.0）
- [ ] 测试场景（Verification Document v2.0）
- [ ] API 设计文档（后端 API 接口定义）
- [ ] 数据模型设计（数据库 Schema）
- [ ] 资源池管理方案（后端架构）

---

## 📝 文档变更历史

**v2.0 - 2025-10-26（最终版）**
- 完全重新设计用户体验流程
- 核心策略：零门槛体验 + 聊天为中心 + Box 为核心价值
- 界面架构：3 Tab（Chats/Boxes/Me）
- 账户策略：匿名账户 + 3 天试用 + 订阅后可选绑定
- 订阅流程：弹窗式设计 + 资源池预热
- 会话切换：微信模式（会话列表优先）
- **命名决策**：最终采用 Boxes（品牌一致性，核心价值突出）
- **Boxes 定位**：类似"联系人"概念，一对多会话，未来多类型扩展
- **详细设计**：单 Box 场景（丰富信息）+ 多 Box 场景（列表视图）

**v2.0-draft - 2025-10-26（初稿）**
- 初版使用 Servers 命名，后经讨论改为 Boxes

**v1.0（已废弃）**
- PRD v1.0、订阅用户流程、页面架构设计等旧版文档已被本文档取代

---

## ✅ 下一步行动

### 立即行动（待确认后执行）
1. **确认本文档**：与团队对齐核心策略和设计方向
2. **解决待定事项**：讨论并决策"待定事项"章节中的 7 个问题
3. **创建实施计划**：基于本文档创建详细的实施计划（Phase 划分、技术方案）

### 后续行动（实施阶段）
1. **创建测试文档**：定义验收标准和测试场景
2. **技术预研**：资源池管理方案、匿名账户实现、支付集成
3. **原型设计**：高保真原型（Figma）
4. **开发实施**：按 Phase 逐步实现

---

**文档状态：初稿（Draft）**
**待确认：核心策略、界面架构、用户流程**
**下一步：团队评审 → 解决待定事项 → 创建实施计划**

---

**Tags:** #design:user-experience #design:navigation #feature:mobile-first #feature:subscription #principle:simplicity #principle:experience-over-purity
